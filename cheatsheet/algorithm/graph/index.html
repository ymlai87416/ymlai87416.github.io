<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Graph - Tom personal site</title><meta name=Description content="Tom personal web site"><meta property="og:title" content="Graph"><meta property="og:description" content="Graph Data structure Adj list Shortcut: graph.adjlist
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  class Pair implements Comparable<Pair> { int first; int second; public Pair(int first, int second) { this.first = first; this.second = second; } @Override public int compareTo(Pair o) { if (first < o.first) return -1; else if (first > o."><meta property="og:type" content="article"><meta property="og:url" content="https://ymlai87416.github.io/cheatsheet/algorithm/graph/"><meta property="og:image" content="https://ymlai87416.github.io/logo.png"><meta property="article:section" content="cheatsheet"><meta property="article:published_time" content="2022-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ymlai87416.github.io/logo.png"><meta name=twitter:title content="Graph"><meta name=twitter:description content="Graph Data structure Adj list Shortcut: graph.adjlist
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  class Pair implements Comparable<Pair> { int first; int second; public Pair(int first, int second) { this.first = first; this.second = second; } @Override public int compareTo(Pair o) { if (first < o.first) return -1; else if (first > o."><meta name=application-name content="Tom personal web site"><meta name=apple-mobile-web-app-title content="Tom personal web site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ymlai87416.github.io/cheatsheet/algorithm/graph/><link rel=prev href=https://ymlai87416.github.io/cheatsheet/algorithm/math/><link rel=next href=https://ymlai87416.github.io/cheatsheet/algorithm/dp/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Graph","inLanguage":"zh","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ymlai87416.github.io\/cheatsheet\/algorithm\/graph\/"},"image":["https:\/\/ymlai87416.github.io\/images\/Apple-Devices-Preview.png"],"genre":"cheatsheet","wordcount":4569,"url":"https:\/\/ymlai87416.github.io\/cheatsheet\/algorithm\/graph\/","datePublished":"2022-04-04T00:00:00+00:00","dateModified":"2022-04-04T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Tom","logo":"https:\/\/ymlai87416.github.io\/images\/avatar.jpg"},"author":{"@type":"Person","name":"Tom"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/blog/>Blog </a><a class=menu-item href=/cheatsheet/>Cheatsheet </a><a class=menu-item href=/tools/>Tools </a><a class=menu-item href=/link/>Link </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/blog/ title>Blog</a><a class=menu-item href=/cheatsheet/ title>Cheatsheet</a><a class=menu-item href=/tools/ title>Tools</a><a class=menu-item href=/link/ title>Link</a><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title></h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Graph</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Tom</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-04-04>2022-04-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span></span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#data-structure>Data structure</a><ul><li><a href=#adj-list>Adj list</a></li><li><a href=#adj-matrix>Adj Matrix</a></li><li><a href=#edge-list>Edge list</a></li></ul></li><li><a href=#bfs>BFS</a><ul><li><a href=#meet-in-the-middle>Meet in the middle</a></li></ul></li><li><a href=#dfs>DFS</a><ul><li><a href=#iterative-deepening-depth-first-search>iterative deepening depth-first search</a></li></ul></li><li><a href=#connected-component>connected component</a></li><li><a href=#strongly-connected-component>Strongly connected component</a></li><li><a href=#flood-fill>flood fill</a></li><li><a href=#minimum-spanning-tree>Minimum spanning tree</a><ul><li><a href=#kruskal>Kruskal</a></li><li><a href=#prim>Prim</a></li></ul></li><li><a href=#shortest-path>Shortest path</a><ul><li><a href=#single-source-shortest-path>Single source shortest path</a></li><li><a href=#bellman-ford>Bellman ford</a></li><li><a href=#shortest-path-faster-algorithm>Shortest Path Faster Algorithm</a></li><li><a href=#floyd-warshall---all-pair-shortest-path>Floyd Warshall - All pair shortest path</a></li></ul></li><li><a href=#articulation-point-and-bridges>Articulation point and bridges</a></li><li><a href=#network-flow>Network flow</a><ul><li><a href=#ford-fulkerson>Ford Fulkerson</a></li><li><a href=#edmond-karp>Edmond Karp</a></li><li><a href=#dinic>Dinic</a></li><li><a href=#find-min-cut-nodes>Find min-cut nodes</a></li></ul></li><li><a href=#bipartite-graph>bipartite graph</a><ul><li><a href=#check>Check</a></li><li><a href=#hopcroft-karps-algorithm>Hopcroft Karp&rsquo;s algorithm</a></li></ul></li><li><a href=#dag>DAG</a></li><li><a href=#topological-sort>Topological sort</a><ul><li><a href=#dfs-1>DFS</a></li><li><a href=#kahns-algorithm>Kahn&rsquo;s algorithm</a></li></ul></li><li><a href=#graph-matching>Graph matching</a><ul><li><a href=#unweighted-mcbm>Unweighted MCBM</a></li><li><a href=#weighted-mcbm>Weighted MCBM</a></li><li><a href=#unweighted-mcm>Unweighted MCM</a></li><li><a href=#weighted-mcm>Weighted MCM</a></li></ul></li><li><a href=#tree>Tree</a><ul><li><a href=#minimum-vertex-cover-tree>Minimum vertex cover tree</a></li><li><a href=#display-order>Display order</a></li></ul></li><li><a href=#euler-graph>Euler graph</a><ul><li><a href=#check-1>Check</a></li><li><a href=#cycle-and-path>Cycle and Path</a></li></ul></li><li><a href=#a>A*</a><ul><li><a href=#iterative-deepening-a>Iterative deepening A*</a></li></ul></li><li><a href=#chinese-postman-problem>Chinese postman problem</a></li></ul></nav></div></div><div class=content id=content><h1 id=graph>Graph</h1><h2 id=data-structure>Data structure</h2><h3 id=adj-list>Adj list</h3><p>Shortcut: graph.adjlist</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Pair</span> <span class=kd>implements</span> <span class=n>Comparable</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>first</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Pair</span><span class=o>(</span><span class=kt>int</span> <span class=n>first</span><span class=o>,</span> <span class=kt>int</span> <span class=n>second</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>first</span> <span class=o>=</span> <span class=n>first</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>second</span> <span class=o>=</span> <span class=n>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>compareTo</span><span class=o>(</span><span class=n>Pair</span> <span class=n>o</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>first</span> <span class=o>&lt;</span> <span class=n>o</span><span class=o>.</span><span class=na>first</span><span class=o>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>first</span> <span class=o>&gt;</span> <span class=n>o</span><span class=o>.</span><span class=na>first</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>second</span> <span class=o>&lt;</span> <span class=n>o</span><span class=o>.</span><span class=na>second</span><span class=o>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>second</span> <span class=o>&gt;</span> <span class=n>o</span><span class=o>.</span><span class=na>second</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>static</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;[]</span> <span class=n>adj</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>[</span><span class=n>20001</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>adj</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=o>++</span><span class=n>i</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=n>adj</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=adj-matrix>Adj Matrix</h3><p>Shortcut: graph.adjlist</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kt>int</span><span class=o>[][]</span> <span class=n>AdjMat</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>101</span><span class=o>][</span><span class=n>101</span><span class=o>];</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=edge-list>Edge list</h3><p>Use by Kruskal algorithm, which sort the edge according to weighting.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Tuple</span> <span class=kd>implements</span> <span class=n>Comparable</span><span class=o>&lt;</span><span class=n>Tuple</span><span class=o>&gt;{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>first</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>second</span><span class=o>,</span> <span class=n>third</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Tuple</span><span class=o>(</span><span class=kt>int</span> <span class=n>a</span><span class=o>,</span> <span class=kt>int</span> <span class=n>b</span><span class=o>,</span> <span class=kt>int</span> <span class=n>c</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>first</span> <span class=o>=</span> <span class=n>a</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>second</span> <span class=o>=</span> <span class=n>b</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>third</span> <span class=o>=</span> <span class=n>c</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>compareTo</span><span class=o>(</span><span class=n>Tuple</span> <span class=n>o</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>first</span> <span class=o>&lt;</span> <span class=n>o</span><span class=o>.</span><span class=na>first</span><span class=o>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span><span class=o>(</span><span class=n>first</span> <span class=o>&gt;</span> <span class=n>o</span><span class=o>.</span><span class=na>first</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>second</span> <span class=o>&lt;</span> <span class=n>o</span><span class=o>.</span><span class=na>second</span><span class=o>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=k>if</span><span class=o>(</span><span class=n>second</span> <span class=o>&gt;</span> <span class=n>o</span><span class=o>.</span><span class=na>second</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>(</span><span class=n>third</span> <span class=o>&lt;</span> <span class=n>o</span><span class=o>.</span><span class=na>third</span><span class=o>)</span> <span class=k>return</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=k>if</span><span class=o>(</span><span class=n>third</span> <span class=o>&gt;</span> <span class=n>o</span><span class=o>.</span><span class=na>third</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=k>return</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Stack</span><span class=o>&lt;</span><span class=n>Tuple</span><span class=o>&gt;</span> <span class=n>EdgeList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Tuple</span><span class=o>&gt;();</span> <span class=c1>// (weight, two vertices) of the edge
</span></span></span></code></pre></td></tr></table></div></div><h2 id=bfs>BFS</h2><p>Only iterative version, no recursive version.</p><p>Time complexity: O(V + E)
Shortcut: graph.bfs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TODO: fix it ASAP
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1_000_000_000</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>d</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>[</span><span class=n>s</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>queue</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=o>(!</span><span class=n>queue</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>p</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>p</span><span class=o>&lt;</span><span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=o>++</span><span class=n>p</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>d</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>INF</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>d</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>d</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/WeightedDijkstraEasier/UVA10986.java target=_blank rel="noopener noreffer">UVA10986</a></p><h3 id=meet-in-the-middle>Meet in the middle</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TODO: implement
</span></span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/MoreAdvanceTopic/MeetInTheMiddle_A_IDA/UVA11212.java target=_blank rel="noopener noreffer">UVA11212</a></p><h2 id=dfs>DFS</h2><p>Time complexity: O(V+E)
Shortcut: graph.dfs.it, graph.dfs.r</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//iterative version
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>dfs</span><span class=o>(</span><span class=kt>int</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>visited</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>boolean</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// depth-first search using an explicit stack
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>visited</span><span class=o>[</span><span class=n>s</span><span class=o>]</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>stack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(!</span><span class=n>stack</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>stack</span><span class=o>.</span><span class=na>peek</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>w</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>adjcnt</span><span class=o>[</span><span class=n>v</span><span class=o>];</span> <span class=o>++</span><span class=n>i</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(!</span><span class=n>visited</span><span class=o>[</span><span class=n>adj</span><span class=o>[</span><span class=n>v</span><span class=o>][</span><span class=n>i</span><span class=o>]])</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>adj</span><span class=o>[</span><span class=n>v</span><span class=o>][</span><span class=n>i</span><span class=o>];</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>w</span> <span class=o>!=</span> <span class=o>-</span><span class=n>1</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>visited</span><span class=o>[</span><span class=n>w</span><span class=o>]</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>stack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>w</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>stack</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>dfs_num</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dfs_num</span><span class=o>,</span> <span class=n>UNVISITED</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>dfs</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// DFS for normal usage: as graph traversal algorithm
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>dfs_num</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>VISITED</span><span class=o>;</span> <span class=c1>// important: we mark this vertex as visited
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// default DS: AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>ii</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// v is a (neighbor, weight) pair
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>dfs_num</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>==</span> <span class=n>UNVISITED</span><span class=o>)</span> <span class=c1>// important check to avoid cycle
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dfs</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span> <span class=c1>// recursively visits unvisited neighbors of vertex u
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=c1>// for simple graph traversal, we ignore the weight stored at v.second
</span></span></span></code></pre></td></tr></table></div></div><h3 id=iterative-deepening-depth-first-search>iterative deepening depth-first search</h3><p>Use bfs instead, not much use case here.</p><h2 id=connected-component>connected component</h2><p>Connected component: do a dfs from each vertex, the visited components are the connected components.</p><p>or we can do a union find</p><h2 id=strongly-connected-component>Strongly connected component</h2><p>Time complexity: O(|V|+|E|).</p><p>If graph is smaller, can also use Floyd-Warshall algorithm.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>You can get the number of scc and the corresponding root.
</span></span></span><span class=line><span class=cl><span class=cm>init with
</span></span></span><span class=line><span class=cl><span class=cm>Arrays.fill(dfs_num, UNVISITED);
</span></span></span><span class=line><span class=cl><span class=cm>Arrays.fill(dfs_low, 0);
</span></span></span><span class=line><span class=cl><span class=cm>Arrays.fill(visited, false);
</span></span></span><span class=line><span class=cl><span class=cm>dfsNumberCounter = numSCC = 0;
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Stack</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>S</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>dfsNumberCounter</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>dfs_low</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>boolean</span><span class=o>[]</span> <span class=n>visited</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>dfs_num</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;&gt;</span> <span class=n>AdjList</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>numSCC</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>final</span>  <span class=kt>int</span> <span class=n>UNVISITED</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>tarjanSCC</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>dfs_num</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>dfsNumberCounter</span><span class=o>++;</span> <span class=c1>// dfs_low[u] &lt;= dfs_num[u]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>S</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>u</span><span class=o>);</span> <span class=c1>// stores u in a vector based on order of visitation
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>visited</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=o>(</span><span class=kt>int</span><span class=o>)</span><span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>dfs_num</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>==</span> <span class=n>UNVISITED</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>tarjanSCC</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>visited</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>])</span> <span class=c1>// condition for update
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>],</span> <span class=n>dfs_low</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]);</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>==</span> <span class=n>dfs_num</span><span class=o>[</span><span class=n>u</span><span class=o>])</span> <span class=o>{</span> <span class=c1>// if this is a root (start) of an SCC
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>++</span><span class=n>numSCC</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>//System.out.format(&#34;SCC %d:&#34;, numSCC); // this part is done after recursion
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>S</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span> <span class=n>visited</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>//System.out.format(&#34; %d&#34;, v);
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=o>(</span><span class=n>u</span> <span class=o>==</span> <span class=n>v</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>//System.out.print(&#34;\n&#34;);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=flood-fill>flood fill</h2><p>Assume a 2d map, we want to flood-fill.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>dr</span><span class=o>[]</span> <span class=o>=</span> <span class=o>{</span><span class=n>1</span><span class=o>,</span><span class=n>1</span><span class=o>,</span><span class=n>0</span><span class=o>,-</span><span class=n>1</span><span class=o>,-</span><span class=n>1</span><span class=o>,-</span><span class=n>1</span><span class=o>,</span> <span class=n>0</span><span class=o>,</span> <span class=n>1</span><span class=o>};</span> <span class=c1>// trick to explore an implicit 2D grid
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>dc</span><span class=o>[]</span> <span class=o>=</span> <span class=o>{</span><span class=n>0</span><span class=o>,</span><span class=n>1</span><span class=o>,</span><span class=n>1</span><span class=o>,</span> <span class=n>1</span><span class=o>,</span> <span class=n>0</span><span class=o>,-</span><span class=n>1</span><span class=o>,-</span><span class=n>1</span><span class=o>,-</span><span class=n>1</span><span class=o>};</span> <span class=c1>// S,SE,E,NE,N,NW,W,SW neighbors
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>floodfill</span><span class=o>(</span><span class=kt>char</span><span class=o>[][]</span> <span class=n>grid</span><span class=o>,</span> <span class=kt>int</span> <span class=n>r</span><span class=o>,</span> <span class=kt>int</span> <span class=n>c</span><span class=o>,</span> <span class=kt>char</span> <span class=n>c1</span><span class=o>,</span> <span class=kt>char</span> <span class=n>c2</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// returns the size of CC
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>R</span><span class=o>=</span><span class=n>grid</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=kt>int</span> <span class=n>C</span><span class=o>=</span><span class=n>R</span> <span class=o>&gt;</span> <span class=n>0</span><span class=o>?</span> <span class=n>grid</span><span class=o>[</span><span class=n>0</span><span class=o>].</span><span class=na>length</span><span class=o>:</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>r</span> <span class=o>&lt;</span> <span class=n>0</span> <span class=o>||</span> <span class=n>r</span> <span class=o>&gt;=</span> <span class=n>R</span> <span class=o>||</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>0</span> <span class=o>||</span> <span class=n>c</span> <span class=o>&gt;=</span> <span class=n>C</span><span class=o>)</span> <span class=k>return</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// outside grid
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>grid</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>!=</span> <span class=n>c1</span><span class=o>)</span> <span class=k>return</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// does not have color c1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>1</span><span class=o>;</span> <span class=c1>// adds 1 to ans because vertex (r, c) has c1 as its color
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>grid</span><span class=o>[</span><span class=n>r</span><span class=o>][</span><span class=n>c</span><span class=o>]</span> <span class=o>=</span> <span class=n>c2</span><span class=o>;</span> <span class=c1>// now recolors vertex (r, c) to c2 to avoid cycling!
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>d</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>d</span> <span class=o>&lt;</span> <span class=n>8</span><span class=o>;</span> <span class=n>d</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>+=</span> <span class=n>floodfill</span><span class=o>(</span><span class=n>grid</span><span class=o>,</span> <span class=n>r</span> <span class=o>+</span> <span class=n>dr</span><span class=o>[</span><span class=n>d</span><span class=o>],</span> <span class=n>c</span> <span class=o>+</span> <span class=n>dc</span><span class=o>[</span><span class=n>d</span><span class=o>],</span> <span class=n>c1</span><span class=o>,</span> <span class=n>c2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=o>;</span> <span class=c1>// the code is neat due to dr[] and dc[]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=minimum-spanning-tree>Minimum spanning tree</h2><h3 id=kruskal>Kruskal</h3><p>Time complexity:
Shortcut: graph.kruskal</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//require tuple
</span></span></span><span class=line><span class=cl><span class=c1>//require union find
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kt>int</span> <span class=nf>kruskal</span><span class=o>(</span><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Tuple</span><span class=o>&gt;</span> <span class=n>EdgeList</span><span class=o>,</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Tuple</span><span class=o>&gt;</span> <span class=n>result</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>Collections</span><span class=o>.</span><span class=na>sort</span><span class=o>(</span><span class=n>EdgeList</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mst_cost</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>UnionFind</span> <span class=n>UF</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UnionFind</span><span class=o>(</span><span class=n>m</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>UF</span><span class=o>.</span><span class=na>init</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Tuple</span> <span class=n>front</span> <span class=o>=</span> <span class=n>EdgeList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(!</span><span class=n>UF</span><span class=o>.</span><span class=na>isSameSet</span><span class=o>(</span><span class=n>front</span><span class=o>.</span><span class=na>second</span><span class=o>,</span> <span class=n>front</span><span class=o>.</span><span class=na>third</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>mst_cost</span> <span class=o>+=</span> <span class=n>front</span><span class=o>.</span><span class=na>first</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>front</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>UF</span><span class=o>.</span><span class=na>unionSet</span><span class=o>(</span><span class=n>front</span><span class=o>.</span><span class=na>second</span><span class=o>,</span> <span class=n>front</span><span class=o>.</span><span class=na>third</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mst_cost</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/MSTVariants/UVA10600.java target=_blank rel="noopener noreffer">UVA10600</a></p><h3 id=prim>Prim</h3><p>TODO: check with cp3</p><p>Time complexity:
Shortcut: graph.prim</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><h2 id=shortest-path>Shortest path</h2><h3 id=single-source-shortest-path>Single source shortest path</h3><h4 id=bfs-1>BFS</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//this version with distance
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dist</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>dist</span><span class=o>[</span><span class=n>s</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// INF = 1Billion to avoid overflow
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;</span> <span class=n>pq</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>pq</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>0</span><span class=o>,</span> <span class=n>s</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=o>(!</span><span class=n>pq</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span> <span class=c1>// main loop
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Pair</span> <span class=n>front</span> <span class=o>=</span> <span class=n>pq</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d</span> <span class=o>=</span> <span class=n>front</span><span class=o>.</span><span class=na>first</span><span class=o>,</span> <span class=n>u</span> <span class=o>=</span> <span class=n>front</span><span class=o>.</span><span class=na>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>d</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>])</span> <span class=k>continue</span><span class=o>;</span> <span class=c1>// this is a very important check
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// all outgoing edges from u
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>v</span><span class=o>.</span><span class=na>second</span> <span class=o>&lt;</span> <span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>v</span><span class=o>.</span><span class=na>second</span><span class=o>;</span> <span class=c1>// relax operation
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>pq</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>],</span> <span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=c1>// this variant can cause duplicate items in the priority queue
</span></span></span></code></pre></td></tr></table></div></div><h4 id=dijkstra>Dijkstra</h4><p>Time complexity: O((V+E) logV)
Shortcut: graph.dij</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//require pair
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>static</span> <span class=kt>int</span><span class=o>[]</span> <span class=n>dist</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>102</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1000000000</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//the result is in dist array
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kt>void</span> <span class=nf>dijkstra</span><span class=o>(</span><span class=kt>int</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dist</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>dist</span><span class=o>[</span><span class=n>e</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// INF = 1Billion to avoid overflow
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;</span> <span class=n>pq</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>pq</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>0</span><span class=o>,</span> <span class=n>e</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(!</span><span class=n>pq</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span> <span class=c1>// main loop
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Pair</span> <span class=n>front</span> <span class=o>=</span> <span class=n>pq</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>d</span> <span class=o>=</span> <span class=n>front</span><span class=o>.</span><span class=na>first</span><span class=o>,</span> <span class=n>u</span> <span class=o>=</span> <span class=n>front</span><span class=o>.</span><span class=na>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>d</span> <span class=o>&gt;</span> <span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>])</span> <span class=k>continue</span><span class=o>;</span> <span class=c1>// this is a very important check
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// all outgoing edges from u
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=o>(</span><span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>v</span><span class=o>.</span><span class=na>second</span> <span class=o>&lt;</span> <span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>v</span><span class=o>.</span><span class=na>second</span><span class=o>;</span> <span class=c1>// relax operation
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>pq</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>],</span> <span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=c1>// this variant can cause duplicate items in the priority queue
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=bellman-ford>Bellman ford</h3><p>Can handle negative cycle</p><p>Time complexity: O(VE)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;[]</span> <span class=n>adj</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>[</span><span class=n>201</span><span class=o>];</span> 
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1_000_000_000</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>dist</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>201</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//place the source at 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=nf>bellman_ford</span><span class=o>(</span><span class=kt>int</span> <span class=n>S</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dist</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>dist</span><span class=o>[</span><span class=n>S</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>-</span> <span class=n>1</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// relax all E edges V-1 times
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>u</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>u</span><span class=o>++)</span> <span class=c1>// these two loops = O(E), overall O(VE)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// record SP spanning here if needed
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dist</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>],</span> <span class=n>dist</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>v</span><span class=o>.</span><span class=na>second</span><span class=o>);</span> <span class=c1>// relax
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/NegativeWeightCycleBellmanFord/UVA10449.java target=_blank rel="noopener noreffer">UVA10449</a></p><h3 id=shortest-path-faster-algorithm>Shortest Path Faster Algorithm</h3><p>This algorithm run as fast as Dijkstra, but it can handle negative cycle.</p><p>Time complexity: O(k * E)
Shortcut: graph.spfa</p><p>//TODO: To be completed</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><h3 id=floyd-warshall---all-pair-shortest-path>Floyd Warshall - All pair shortest path</h3><p>Time complexity: O(V^3)
Shortcut: graph.floyd</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Can</span> <span class=n>be</span> <span class=n>used</span> <span class=n>to</span> 
</span></span><span class=line><span class=cl><span class=o>*</span> <span class=n>detected</span> <span class=n>the</span> <span class=n>negative</span> <span class=n>cycle</span>
</span></span><span class=line><span class=cl><span class=o>*</span> <span class=n>SCC</span> <span class=o>=&gt;</span> <span class=k>if</span> <span class=n>Adj</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=n>and</span> <span class=n>Adj</span><span class=o>[</span><span class=n>j</span><span class=o>][</span><span class=n>i</span><span class=o>]</span> <span class=n>are</span> <span class=n>not</span> <span class=n>INF</span><span class=o>,</span> <span class=n>they</span> <span class=n>belongs</span> <span class=n>to</span> <span class=n>same</span> <span class=n>SCC</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=o>*</span> <span class=n>Radius</span> <span class=n>of</span> <span class=n>the</span> <span class=n>graph</span>
</span></span><span class=line><span class=cl><span class=o>*</span> <span class=n>Minmax</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>```</span><span class=n>java</span>
</span></span><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1000000000</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>flyodWarshall</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inside int main()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// precondition: AdjMat[i][j] contains the weight of edge (i, j)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// or INF (1B) if there is no such edge
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// AdjMat is a 32-bit signed integer array
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>k</span><span class=o>++)</span> <span class=c1>// remember that loop order is k-&gt;i-&gt;j
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>j</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>                <span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>],</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>k</span><span class=o>]</span> <span class=o>+</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>k</span><span class=o>][</span><span class=n>j</span><span class=o>]);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/AllPairShortestPathStandard/UVA11463.java target=_blank rel="noopener noreffer">UVA11463</a></p><h4 id=print-shortest-path>Print shortest path</h4><p>Shortcut: graph.floyd.print</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1000000000</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>flyodWarshall</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inside int main()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// precondition: AdjMat[i][j] contains the weight of edge (i, j)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// or INF (1B) if there is no such edge
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// AdjMat is a 32-bit signed integer array
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>k</span><span class=o>++)</span> <span class=c1>// remember that loop order is k-&gt;i-&gt;j
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>V</span><span class=o>;</span> <span class=n>j</span><span class=o>++)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=o>((</span><span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>k</span><span class=o>]</span> <span class=o>+</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>k</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>&lt;</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>k</span><span class=o>]</span> <span class=o>+</span> <span class=n>AdjMat</span><span class=o>[</span><span class=n>k</span><span class=o>][</span><span class=n>j</span><span class=o>];</span>
</span></span><span class=line><span class=cl>                    <span class=n>p</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>p</span><span class=o>[</span><span class=n>k</span><span class=o>][</span><span class=n>j</span><span class=o>]</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>printPath</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>int</span> <span class=n>j</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>i</span> <span class=o>!=</span> <span class=n>j</span><span class=o>)</span> <span class=n>printPath</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=n>p</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34; &#34;</span> <span class=o>+</span> <span class=n>j</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=articulation-point-and-bridges>Articulation point and bridges</h2><p>Time complexity: O(V + E)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>dfsNumberCounter</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;&gt;</span> <span class=n>AdjList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>dfs_num</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>dfs_low</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>dfs_parent</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>articulation_vertex</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>boolean</span><span class=o>[</span><span class=n>V</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>UNVISITED</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dfs_num</span><span class=o>,</span> <span class=n>UNVISITED</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dfs_low</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>dfs_parent</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>articulation_vertex</span><span class=o>,</span> <span class=kc>false</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>articulationPointAndBridge</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>dfs_num</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>dfsNumberCounter</span><span class=o>++;</span> <span class=c1>// dfs_low[u] &lt;= dfs_num[u]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=o>(</span><span class=kt>int</span><span class=o>)</span><span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>dfs_num</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>==</span> <span class=n>UNVISITED</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// a tree edge
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dfs_parent</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>u</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>u</span> <span class=o>==</span> <span class=n>dfsRoot</span><span class=o>)</span> <span class=n>rootChildren</span><span class=o>++;</span> <span class=c1>// special case if u is a root
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>articulationPointAndBridge</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>dfs_low</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>&gt;=</span> <span class=n>dfs_num</span><span class=o>[</span><span class=n>u</span><span class=o>])</span> <span class=c1>// for articulation point
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>articulation_vertex</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span> <span class=c1>// store this information first
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//if (dfs_low[v.first] &gt; dfs_num[u]) // for bridge
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>//    bridges.add(new Pair(Math.min(u, v.first), Math.max(u, v.first)));
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>],</span> <span class=n>dfs_low</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]);</span> <span class=c1>// update dfs_low[u]
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span> <span class=o>!=</span> <span class=n>dfs_parent</span><span class=o>[</span><span class=n>u</span><span class=o>])</span> <span class=c1>// a back edge and not direct cycle
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dfs_low</span><span class=o>[</span><span class=n>u</span><span class=o>],</span> <span class=n>dfs_num</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]);</span> <span class=c1>// update dfs_low[u]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/ArticulationPoints/UVA10765.java target=_blank rel="noopener noreffer">UVA10765</a></p><h2 id=network-flow>Network flow</h2><p>Find the max flow of the graph, the value is also equal to the min cut.
Can also apply on bipartite grpah, result in maximum cardinality bipartite matching. (each edge weight is 1)</p><p>There are 3 different path augment algorithms, just different favor, and runtime more or less the same.</p><table><thead><tr><th></th><th>11380 Down Went The Titanic</th><th>820 Internet Bandwidth</th></tr></thead><tbody><tr><td>Ford Fulkerson</td><td>0.75</td><td>0.33</td></tr><tr><td>Edmond Karp</td><td>0.88</td><td>0.35</td></tr><tr><td>Dinic</td><td>0.81</td><td>0.36</td></tr></tbody></table><h3 id=ford-fulkerson>Ford Fulkerson</h3><p>Not a good candidate for contest because f can be large.</p><p>Time complexity: O(f* E) where f* = maximum flow
Shortcut: graph.ff</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span><span class=o>[][]</span> <span class=n>res</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>][</span><span class=n>maxV</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>mf</span><span class=o>,</span> <span class=n>f</span><span class=o>,</span> <span class=n>s</span><span class=o>,</span> <span class=n>t</span><span class=o>;</span> <span class=c1>// global variables
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>p</span><span class=o>;</span> <span class=c1>// p stores the BFS spanning tree from s
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>augment</span><span class=o>(</span><span class=kt>int</span> <span class=n>v</span><span class=o>,</span> <span class=kt>int</span> <span class=n>minEdge</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// traverse BFS spanning tree from s-&gt;t
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>v</span> <span class=o>==</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=n>f</span> <span class=o>=</span> <span class=n>minEdge</span><span class=o>;</span> <span class=k>return</span><span class=o>;</span> <span class=o>}</span> <span class=c1>// record minEdge in a global var f
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>!=</span> <span class=o>-</span><span class=n>1</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>augment</span><span class=o>(</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>],</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>minEdge</span><span class=o>,</span> <span class=n>res</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]][</span><span class=n>v</span><span class=o>]));</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]][</span><span class=n>v</span><span class=o>]</span> <span class=o>-=</span> <span class=n>f</span><span class=o>;</span> <span class=n>res</span><span class=o>[</span><span class=n>v</span><span class=o>][</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]]</span> <span class=o>+=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BitSet</span> <span class=n>vis</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>fulkerson</span><span class=o>(</span><span class=kt>int</span> <span class=n>sIdx</span><span class=o>,</span> <span class=kt>int</span> <span class=n>tIdx</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>sIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>tIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inside int main(), assume that we have both res (AdjMatrix) and AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>mf</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// now a true O(VE^2) Edmonds Karps algorithm
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>BitSet</span> <span class=n>vis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BitSet</span><span class=o>(</span><span class=n>maxV</span><span class=o>);</span> <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>s</span><span class=o>);</span> <span class=c1>// we change vi dist to bitset!
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>];</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>p</span><span class=o>,</span> <span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>dfs</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>q</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span> <span class=n>q</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>augment</span><span class=o>(</span><span class=n>t</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>f</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>mf</span> <span class=o>+=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mf</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dfs</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// AdjList here!
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// we use vector&lt;vi&gt; AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>res</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>v</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>vis</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=n>u</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>dfs</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=edmond-karp>Edmond Karp</h3><p>Time complexity: O(VE^2)
Shortcut: graph.ek</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span><span class=o>[][]</span> <span class=n>res</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>][</span><span class=n>maxV</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>mf</span><span class=o>,</span> <span class=n>f</span><span class=o>,</span> <span class=n>s</span><span class=o>,</span> <span class=n>t</span><span class=o>;</span> <span class=c1>// global variables
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>p</span><span class=o>;</span> <span class=c1>// p stores the BFS spanning tree from s
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>augment</span><span class=o>(</span><span class=kt>int</span> <span class=n>v</span><span class=o>,</span> <span class=kt>int</span> <span class=n>minEdge</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// traverse BFS spanning tree from s-&gt;t
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>v</span> <span class=o>==</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=n>f</span> <span class=o>=</span> <span class=n>minEdge</span><span class=o>;</span> <span class=k>return</span><span class=o>;</span> <span class=o>}</span> <span class=c1>// record minEdge in a global var f
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>!=</span> <span class=o>-</span><span class=n>1</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>augment</span><span class=o>(</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>],</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>minEdge</span><span class=o>,</span> <span class=n>res</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]][</span><span class=n>v</span><span class=o>]));</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=o>[</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]][</span><span class=n>v</span><span class=o>]</span> <span class=o>-=</span> <span class=n>f</span><span class=o>;</span> <span class=n>res</span><span class=o>[</span><span class=n>v</span><span class=o>][</span><span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]]</span> <span class=o>+=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>edmondKarp</span><span class=o>(</span><span class=kt>int</span> <span class=n>sIdx</span><span class=o>,</span> <span class=kt>int</span> <span class=n>tIdx</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>sIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>tIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inside int main(), assume that we have both res (AdjMatrix) and AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>mf</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// now a true O(VE^2) Edmonds Karps algorithm
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>BitSet</span> <span class=n>vis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BitSet</span><span class=o>(</span><span class=n>maxV</span><span class=o>);</span> <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>s</span><span class=o>);</span> <span class=c1>// we change vi dist to bitset!
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>q</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span> <span class=n>q</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>];</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>p</span><span class=o>,</span> <span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(!</span><span class=n>q</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>q</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>u</span> <span class=o>==</span> <span class=n>t</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// AdjList here!
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// we use vector&lt;vi&gt; AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=o>(</span><span class=n>res</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>v</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>vis</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>q</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=n>u</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>augment</span><span class=o>(</span><span class=n>t</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>f</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>mf</span> <span class=o>+=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mf</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/NetworkFlow/Variants/UVA11380.java target=_blank rel="noopener noreffer">UVA11380</a></p><h3 id=dinic>Dinic</h3><p>Dinic reduce to Hopcraft-Karp?</p><p>Time complexity: O(V^2 E)
Shortcut: graph.dinic</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//new code at: https://github.com/stevenhalim/cpbook-code/blob/master/ch8/maxflow.java
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>d</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>dinic</span><span class=o>(</span><span class=kt>int</span> <span class=n>sIdx</span><span class=o>,</span> <span class=kt>int</span> <span class=n>tIdx</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>sIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>tIdx</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inside int main(), assume that we have both res (AdjMatrix) and AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>mf</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// now a true O(VE^2) Edmonds Karps algorithm
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BitSet</span><span class=o>(</span><span class=n>maxV</span><span class=o>);</span> <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>s</span><span class=o>);</span> <span class=c1>// we change vi dist to bitset!
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>q</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span> <span class=n>q</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>d</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>];</span> <span class=n>d</span><span class=o>[</span><span class=n>s</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>];</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>p</span><span class=o>,</span> <span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(!</span><span class=n>q</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>q</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>u</span> <span class=o>==</span> <span class=n>t</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// AdjList here!
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// we use vector&lt;vi&gt; AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=o>(</span><span class=n>res</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>v</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>vis</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>q</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>d</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=n>d</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>+</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=n>u</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>sf</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=o>(</span><span class=kc>true</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>augment</span><span class=o>(</span><span class=n>t</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>f</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>sf</span> <span class=o>+=</span> <span class=n>f</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>vis</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BitSet</span><span class=o>(</span><span class=n>maxV</span><span class=o>);</span> <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>maxV</span><span class=o>];</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>p</span><span class=o>,</span> <span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>dfs2</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>        this is an optimization.
</span></span></span><span class=line><span class=cl><span class=cm>        for(int v=0; v&lt;maxV; ++v){
</span></span></span><span class=line><span class=cl><span class=cm>            if(d[v]+1 == d[t]) {
</span></span></span><span class=line><span class=cl><span class=cm>                f = 0;
</span></span></span><span class=line><span class=cl><span class=cm>                augment(v, Math.min(INF, res[v][t]));
</span></span></span><span class=line><span class=cl><span class=cm>                res[v][t] -= f; res[t][v] += f;
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>                sf += f;
</span></span></span><span class=line><span class=cl><span class=cm>            }
</span></span></span><span class=line><span class=cl><span class=cm>        }
</span></span></span><span class=line><span class=cl><span class=cm>        */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>sf</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>mf</span> <span class=o>+=</span> <span class=n>sf</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mf</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>dfs2</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// AdjList here!
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span> <span class=c1>// we use vector&lt;vi&gt; AdjList
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>d</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>d</span><span class=o>[</span><span class=n>u</span><span class=o>]+</span><span class=n>1</span> <span class=o>&amp;&amp;</span> <span class=n>res</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>v</span><span class=o>]</span> <span class=o>&gt;</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>vis</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>vis</span><span class=o>.</span><span class=na>set</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>=</span> <span class=n>u</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>dfs</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=find-min-cut-nodes>Find min-cut nodes</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TODO: to be completed
</span></span></span></code></pre></td></tr></table></div></div><h2 id=bipartite-graph>bipartite graph</h2><h3 id=check>Check</h3><p>Use BFS to do the checking.</p><p>Time complexity: O(V+E)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>INF</span> <span class=o>=</span> <span class=n>1_000_000_000</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>color</span><span class=o>,</span> <span class=n>INF</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Queue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayDeque</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>bool</span> <span class=n>isBipartite</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span> 
</span></span><span class=line><span class=cl><span class=n>color</span><span class=o>[</span><span class=n>s</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>queue</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=o>(!</span><span class=n>queue</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>()</span> <span class=o>&amp;</span> <span class=n>isBipartite</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>p</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>p</span><span class=o>&lt;</span><span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=o>++</span><span class=n>p</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>p</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>visited</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>INF</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>color</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>=</span> <span class=n>1</span> <span class=o>-</span> <span class=n>color</span><span class=o>[</span><span class=n>u</span><span class=o>];</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span><span class=o>(</span><span class=n>color</span><span class=o>[</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>]</span> <span class=o>==</span> <span class=n>color</span><span class=o>[</span><span class=n>u</span><span class=o>]){</span>
</span></span><span class=line><span class=cl>            <span class=n>isBipartite</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=hopcroft-karps-algorithm>Hopcroft Karp&rsquo;s algorithm</h3><p>You can add a source and sink to the graph, and run Edmonds Karp.</p><p>Time complexity: O(sqrt(V) * E)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TODO: to be implemented
</span></span></span></code></pre></td></tr></table></div></div><p><a href=https://leetcode.com/problems/maximum-students-taking-exam/discuss/1734630/C%2B%2B-Two-solutions%3A-Optimized-bitmask-DP-and-Hopcroft-Karp-Bipartite-MIS target=_blank rel="noopener noreffer">Test</a></p><h2 id=dag>DAG</h2><h2 id=topological-sort>Topological sort</h2><p>Linear ordering of vertices such taht for every directed edge uv, vertex u comes before v in the ordering.</p><h3 id=dfs-1>DFS</h3><p>If any ordering will do, prefer this algorithm</p><p>Time complexity: O(V+E)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>EXPLORED</span> <span class=o>=</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>VISITED</span> <span class=o>=</span> <span class=n>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>UNVISITED</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ts</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>numCourses</span><span class=o>;</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=c1>//do dfs if not visted
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=o>(</span><span class=n>visited</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>==</span> <span class=n>UNVISITED</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=kt>boolean</span> <span class=n>hasCycle</span> <span class=o>=</span> <span class=n>dfs</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>hasCycle</span><span class=o>)</span> 
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Have cycle, no topological sort&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>Collections</span><span class=o>.</span><span class=na>reverse</span><span class=o>(</span><span class=n>ts</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>result</span> <span class=o>=</span><span class=n>ts</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>boolean</span> <span class=nf>dfs</span><span class=o>(</span><span class=kt>int</span> <span class=n>u</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>visited</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>EXPLORED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adjList</span><span class=o>[</span><span class=n>u</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//System.out.println(&#34;&#34; + u + &#34;-&gt;&#34; + v + &#34;:&#34; + visited[v]);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span><span class=o>(</span><span class=n>visited</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>EXPLORED</span><span class=o>)</span> <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>visited</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>VISITED</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>boolean</span> <span class=n>hasCycle</span> <span class=o>=</span> <span class=n>dfs</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>hasCycle</span><span class=o>)</span> <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>visited</span><span class=o>[</span><span class=n>u</span><span class=o>]</span> <span class=o>=</span> <span class=n>VISITED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/TopologicalSort/UVA11060.java target=_blank rel="noopener noreffer">UVA11060</a></p><p>Refer: <a href=https://leetcode.com/submissions/detail/691062853/ target=_blank rel="noopener noreffer">Course Schedule II</a></p><h3 id=kahns-algorithm>Kahn&rsquo;s algorithm</h3><p>When additional requirement like take the one which appears first in the input. This algorithm works.</p><p>Time complexity: O(V+E)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=nf>Kahn</span><span class=o>(</span><span class=kt>int</span> <span class=n>V</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//this either sort all, or fail to sort any.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>queue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PriorityQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>answer</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>V</span><span class=o>;</span> <span class=o>++</span><span class=n>i</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>indegree</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>==</span> <span class=n>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>indegree</span><span class=o>[</span><span class=n>i</span><span class=o>]--;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=o>(!</span><span class=n>queue</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>u</span><span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=na>poll</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>j</span><span class=o>&lt;</span><span class=n>adjcnt</span><span class=o>[</span><span class=n>u</span><span class=o>];</span> <span class=o>++</span><span class=n>j</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>indegree</span><span class=o>[</span><span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>j</span><span class=o>]]--;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>adjcnt</span><span class=o>[</span><span class=n>u</span><span class=o>];</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=n>adj</span><span class=o>[</span><span class=n>u</span><span class=o>][</span><span class=n>i</span><span class=o>];</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>indegree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>queue</span><span class=o>.</span><span class=na>offer</span><span class=o>(</span><span class=n>v</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=n>indegree</span><span class=o>[</span><span class=n>v</span><span class=o>]--;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>answer</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>answer</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/Graph/TopologicalSort/UVA11060.java target=_blank rel="noopener noreffer">UVA11060</a></p><h2 id=graph-matching>Graph matching</h2><h3 id=unweighted-mcbm>Unweighted MCBM</h3><p>Hopcroft Karp
Time complexity: O(E*sqrt(V))</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><p>Refer: <a href rel>Maximum Number of Accepted Invitations</a></p><h3 id=weighted-mcbm>Weighted MCBM</h3><p>Hungarian algorithm / Kuhn Munkress algorithm
Time complexity: O(V^3)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><p>Refer: <a href rel>Maximum Number of Accepted Invitations</a></p><h3 id=unweighted-mcm>Unweighted MCM</h3><p>Edmond algorithm
Time complexity:</p><p>if small, apply the DP is also possible.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TOOD: to be completed
</span></span></span></code></pre></td></tr></table></div></div><h3 id=weighted-mcm>Weighted MCM</h3><p>DP with bitmask</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//required numberOfSetBits
</span></span></span><span class=line><span class=cl><span class=c1>//set 1 to node which need to be matched
</span></span></span><span class=line><span class=cl><span class=c1>//second path contained the weight of the edge
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>private</span> <span class=kt>int</span> <span class=nf>weightedMCM</span><span class=o>(</span><span class=kt>int</span> <span class=n>bitmask</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=c1>//pair up someone still not in a group and then return
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=o>(</span><span class=n>dp</span><span class=o>[</span><span class=n>bitmask</span><span class=o>]</span> <span class=o>!=</span> <span class=n>INF</span><span class=o>)</span> <span class=k>return</span> <span class=n>dp</span><span class=o>[</span><span class=n>bitmask</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>NumberOfSetBits</span><span class=o>(</span><span class=n>bitmask</span><span class=o>)</span> <span class=o>==</span> <span class=n>N</span><span class=o>)</span> <span class=k>return</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=n>INF</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>((</span><span class=n>bitmask</span> <span class=o>&amp;</span> <span class=o>(</span><span class=n>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span><span class=o>))</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=n>Pair</span> <span class=n>p</span><span class=o>:</span> <span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>i</span><span class=o>==</span><span class=n>p</span><span class=o>.</span><span class=na>first</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>((</span><span class=n>bitmask</span> <span class=o>&amp;</span> <span class=o>(</span><span class=n>1</span> <span class=o>&lt;&lt;</span> <span class=n>p</span><span class=o>.</span><span class=na>first</span><span class=o>))</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>temp</span> <span class=o>=</span> <span class=n>dpHelper</span><span class=o>(</span><span class=n>bitmask</span> <span class=o>|</span> <span class=o>(</span><span class=n>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span><span class=o>)</span> <span class=o>|</span> <span class=o>(</span><span class=n>1</span> <span class=o>&lt;&lt;</span> <span class=n>p</span><span class=o>.</span><span class=na>first</span><span class=o>))</span> <span class=o>+</span> <span class=n>p</span><span class=o>.</span><span class=na>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>temp</span> <span class=o>&lt;</span> <span class=n>result</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=n>temp</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dp</span><span class=o>[</span><span class=n>bitmask</span><span class=o>]</span> <span class=o>=</span><span class=n>result</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=tree>Tree</h2><h3 id=minimum-vertex-cover-tree>Minimum vertex cover tree</h3><h3 id=display-order>Display order</h3><h4 id=post>Post</h4><p>Post order iterative is a little bit difficult in stack.</p><ol><li>You have to make it in some way, either push it 2 times, or push it with the right under it.</li></ol><p>Shortcut: tree.post.r, tree.post.it</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>postOrder</span><span class=o>(</span><span class=n>TreeNode</span> <span class=n>node</span><span class=o>)</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>node</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span><span class=o>;</span> <span class=o>}</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>left</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>right</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;%s &#34;</span><span class=o>,</span> <span class=n>node</span><span class=o>.</span><span class=na>data</span><span class=o>);</span> 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=nf>postOrderIterative</span><span class=o>(</span><span class=n>Node</span> <span class=n>node</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;</span> <span class=n>S</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=c1>// Check for empty tree
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>node</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>list</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>S</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>node</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Node</span> <span class=n>prev</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(!</span><span class=n>S</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Node</span> <span class=n>current</span> <span class=o>=</span> <span class=n>S</span><span class=o>.</span><span class=na>peek</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* go down the tree in search of a leaf an if so process it
</span></span></span><span class=line><span class=cl><span class=cm>        and pop stack otherwise move down */</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>prev</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>prev</span><span class=o>.</span><span class=na>left</span> <span class=o>==</span> <span class=n>current</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>                                    <span class=n>prev</span><span class=o>.</span><span class=na>right</span> <span class=o>==</span> <span class=n>current</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>left</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>S</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>left</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>right</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>S</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>right</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>S</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=cm>/* go up the tree from left node, if the child is right
</span></span></span><span class=line><span class=cl><span class=cm>            push it onto stack otherwise process parent and pop
</span></span></span><span class=line><span class=cl><span class=cm>            stack */</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>left</span> <span class=o>==</span> <span class=n>prev</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>right</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>S</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>right</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>S</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>                <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=cm>/* go up the tree from right node and after coming back
</span></span></span><span class=line><span class=cl><span class=cm>            from right node process parent and pop stack */</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>right</span> <span class=o>==</span> <span class=n>prev</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>S</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>current</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>prev</span> <span class=o>=</span> <span class=n>current</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>list</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=in>In</h4><p>Shortcut: tree.in.r, tree.in.it</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>inorder</span><span class=o>(</span><span class=n>TreeNode</span> <span class=n>node</span><span class=o>)</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>node</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span><span class=o>;</span> <span class=o>}</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>left</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;%s &#34;</span><span class=o>,</span> <span class=n>node</span><span class=o>.</span><span class=na>data</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>right</span><span class=o>);</span> 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=kt>void</span> <span class=nf>inorder</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>root</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>list</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>Node</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>root</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// traverse the tree
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=o>(</span><span class=n>curr</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>s</span><span class=o>.</span><span class=na>size</span><span class=o>()</span> <span class=o>&gt;</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* Reach the left most Node of the
</span></span></span><span class=line><span class=cl><span class=cm>        curr Node */</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>curr</span> <span class=o>!=</span>  <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=cm>/* place pointer to a tree node on
</span></span></span><span class=line><span class=cl><span class=cm>                the stack before traversing
</span></span></span><span class=line><span class=cl><span class=cm>                the node&#39;s left subtree */</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>curr</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>left</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* Current must be NULL at this point */</span>
</span></span><span class=line><span class=cl>        <span class=n>curr</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=cm>/* we have visited the node and its
</span></span></span><span class=line><span class=cl><span class=cm>            left subtree.  Now, it&#39;s right
</span></span></span><span class=line><span class=cl><span class=cm>            subtree&#39;s turn */</span>
</span></span><span class=line><span class=cl>        <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>right</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://leetcode.com/submissions/detail/691160478/ target=_blank rel="noopener noreffer">Kth Smallest Element in BST</a></p><h4 id=pre>Pre</h4><p>Shortcut: tree.pre.r, tree.pre.it</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>preorder</span><span class=o>(</span><span class=n>TreeNode</span> <span class=n>node</span><span class=o>)</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>node</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span> <span class=k>return</span><span class=o>;</span> <span class=o>}</span> 
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>printf</span><span class=o>(</span><span class=s>&#34;%s &#34;</span><span class=o>,</span> <span class=n>node</span><span class=o>.</span><span class=na>data</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>left</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=n>postOrder</span><span class=o>(</span><span class=n>node</span><span class=o>.</span><span class=na>right</span><span class=o>);</span> 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// An iterative process to print preorder traversal of Binary tree
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=nf>preorder</span><span class=o>(</span><span class=n>Node</span> <span class=n>node</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Base Case    
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>node</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create an empty stack and push root to it
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;</span> <span class=n>nodeStack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Stack</span><span class=o>&lt;</span><span class=n>Node</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=n>nodeStack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>root</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/* Pop all items one by one. Do following for every popped item
</span></span></span><span class=line><span class=cl><span class=cm>        a) print it
</span></span></span><span class=line><span class=cl><span class=cm>        b) push its right child
</span></span></span><span class=line><span class=cl><span class=cm>        c) push its left child
</span></span></span><span class=line><span class=cl><span class=cm>        Note that right child is pushed first so that left is processed first */</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>nodeStack</span><span class=o>.</span><span class=na>empty</span><span class=o>()</span> <span class=o>==</span> <span class=kc>false</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Pop the top item from stack and print it
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Node</span> <span class=n>mynode</span> <span class=o>=</span> <span class=n>nodeStack</span><span class=o>.</span><span class=na>peek</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>mynode</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>nodeStack</span><span class=o>.</span><span class=na>pop</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Push right and left children of the popped node to stack
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>mynode</span><span class=o>.</span><span class=na>right</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>nodeStack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>mynode</span><span class=o>.</span><span class=na>right</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>mynode</span><span class=o>.</span><span class=na>left</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>nodeStack</span><span class=o>.</span><span class=na>push</span><span class=o>(</span><span class=n>mynode</span><span class=o>.</span><span class=na>left</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=euler-graph>Euler graph</h2><p>Although very similiar, Hamiltonian cycle, which pass through every nodes, is NP-complete!</p><h3 id=check-1>Check</h3><p>To have a path: only 2 vertices have odd degree, and start and end from there
To have a tour: all verticies have even degree</p><h3 id=cycle-and-path>Cycle and Path</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TODO: review
</span></span></span><span class=line><span class=cl><span class=c1>//in the adj graph, set second as 1 first
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>cyc</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>EulerTour</span><span class=o>(</span><span class=kt>int</span> <span class=n>idx</span><span class=o>,</span> <span class=kt>int</span> <span class=n>u</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=o>(</span><span class=kt>int</span><span class=o>)</span><span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Pair</span> <span class=n>v</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>u</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>second</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// if this edge can still be used/not removed
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>v</span><span class=o>.</span><span class=na>second</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// make the weight of this edge to be 0 (removed)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>).</span><span class=na>size</span><span class=o>();</span> <span class=n>k</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Pair</span> <span class=n>uu</span> <span class=o>=</span> <span class=n>AdjList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>).</span><span class=na>get</span><span class=o>(</span><span class=n>k</span><span class=o>);</span>  <span class=c1>// remove bi-directional edge once only.
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=o>(</span><span class=n>uu</span><span class=o>.</span><span class=na>first</span> <span class=o>==</span> <span class=n>u</span> <span class=o>&amp;&amp;</span> <span class=n>uu</span><span class=o>.</span><span class=na>second</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>uu</span><span class=o>.</span><span class=na>second</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>cyc</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>idx</span><span class=o>,</span> <span class=n>u</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>EulerTour</span><span class=o>(</span><span class=n>idx</span><span class=o>+</span><span class=n>1</span><span class=o>,</span> <span class=n>v</span><span class=o>.</span><span class=na>first</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>//TODO: please check <a href=https://leetcode.com/submissions/detail/636653134/ target=_blank rel="noopener noreffer">https://leetcode.com/submissions/detail/636653134/</a></p><h2 id=a>A*</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TOOD: to be complete
</span></span></span></code></pre></td></tr></table></div></div><h3 id=iterative-deepening-a>Iterative deepening A*</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//TOOD: to be complete
</span></span></span></code></pre></td></tr></table></div></div><h2 id=chinese-postman-problem>Chinese postman problem</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//require dijsktra
</span></span></span><span class=line><span class=cl><span class=c1>//require weighted MCM
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>private</span> <span class=kt>int</span> <span class=nf>chinesePostman</span><span class=o>(</span><span class=kt>int</span> <span class=n>N</span><span class=o>,</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;[]</span> <span class=n>adjList</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>oddNodes</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=c1>//build a subgraph of odd node and do a minimum weight perfect matching
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>cnt</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>).</span><span class=na>first</span> <span class=o>==</span> <span class=n>i</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=o>++</span><span class=n>cnt</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>cnt</span> <span class=o>%</span><span class=n>2</span><span class=o>==</span><span class=n>1</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=n>oddNodes</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//dijkstra
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//new adjlist
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Pair</span><span class=o>&gt;[]</span> <span class=n>adjListOdd</span><span class=o>=</span>  <span class=k>new</span> <span class=n>ArrayList</span><span class=o>[</span><span class=n>N</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>adjListOdd</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>N</span> <span class=o>=</span> <span class=n>N</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>n</span><span class=o>:</span> <span class=n>oddNodes</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span><span class=o>[]</span> <span class=n>a</span> <span class=o>=</span> <span class=n>dijkstra</span><span class=o>(</span><span class=n>n</span><span class=o>,</span> <span class=n>adjList</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>m</span><span class=o>:</span><span class=n>oddNodes</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>n</span> <span class=o>&gt;=</span> <span class=n>m</span><span class=o>)</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=n>adjListOdd</span><span class=o>[</span><span class=n>n</span><span class=o>].</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>m</span><span class=o>,</span> <span class=n>a</span><span class=o>[</span><span class=n>m</span><span class=o>]));</span>
</span></span><span class=line><span class=cl>            <span class=n>adjListOdd</span><span class=o>[</span><span class=n>m</span><span class=o>].</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>n</span><span class=o>,</span> <span class=n>a</span><span class=o>[</span><span class=n>m</span><span class=o>]));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>adjList</span> <span class=o>=</span> <span class=n>adjListOdd</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//new additional path from minimum weight matching
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>dp</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>INF</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>//set all none related nodes to 1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>bitmask</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>oddNodes</span><span class=o>.</span><span class=na>contains</span><span class=o>(</span><span class=n>i</span><span class=o>))</span> <span class=k>continue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmask</span> <span class=o>=</span> <span class=n>bitmask</span> <span class=o>|</span> <span class=o>(</span><span class=n>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>=</span> <span class=n>weightedMCM</span><span class=o>(</span><span class=n>bitmask</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//add up each path in original graph
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>size</span><span class=o>();</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>i</span> <span class=o>&lt;=</span> <span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>).</span><span class=na>first</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>ans</span>  <span class=o>+=</span> <span class=n>adjList</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>get</span><span class=o>(</span><span class=n>j</span><span class=o>).</span><span class=na>second</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/master/java/src/main/java/RareTopic/ChinesePostmanProblem/UVA10296.java target=_blank rel="noopener noreffer">UVA10296</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/cheatsheet/algorithm/graph/index.md target=_blank></a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()></a></span>&nbsp;|&nbsp;<span><a href=/></a></span></section></div><div class=post-nav><a href=/cheatsheet/algorithm/math/ class=prev rel=prev title=Maths><i class="fas fa-angle-left fa-fw"></i>Maths</a>
<a href=/cheatsheet/algorithm/dp/ class=next rel=next title="Dynamic programming">Dynamic programming<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Lai Yiu Ming, Tom</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"",maxShownLines:100},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>