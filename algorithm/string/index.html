<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Strings - Tom personal site</title><meta name=Description content="Tom personal web site"><meta property="og:title" content="Strings"><meta property="og:description" content="String KMP searching Time complexity: O(m+n)
Can use to detect longest parlindrom from the beginning
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  final int MAX_N = 1_000_001; char[] T = new char[MAX_N]; char[] P = new char[MAX_N]; // T = text, P = pattern int[] b = new int[MAX_N]; int n, m; // b = back table, n = length of T, m = length of P  void kmpPreprocess() { // call this before calling kmpSearch()  int i = 0, j = -1; b[0] = -1; // starting values  while (i < m) { // pre-process the pattern string P  while (j >= 0 && P[i] !"><meta property="og:type" content="article"><meta property="og:url" content="https://ymlai87416.github.io/algorithm/string/"><meta property="og:image" content="https://ymlai87416.github.io/logo.png"><meta property="article:section" content="algorithm"><meta property="article:published_time" content="2022-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ymlai87416.github.io/logo.png"><meta name=twitter:title content="Strings"><meta name=twitter:description content="String KMP searching Time complexity: O(m+n)
Can use to detect longest parlindrom from the beginning
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  final int MAX_N = 1_000_001; char[] T = new char[MAX_N]; char[] P = new char[MAX_N]; // T = text, P = pattern int[] b = new int[MAX_N]; int n, m; // b = back table, n = length of T, m = length of P  void kmpPreprocess() { // call this before calling kmpSearch()  int i = 0, j = -1; b[0] = -1; // starting values  while (i < m) { // pre-process the pattern string P  while (j >= 0 && P[i] !"><meta name=application-name content="Tom personal web site"><meta name=apple-mobile-web-app-title content="Tom personal web site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ymlai87416.github.io/algorithm/string/><link rel=next href=https://ymlai87416.github.io/algorithm/math/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Strings","inLanguage":"zh","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ymlai87416.github.io\/algorithm\/string\/"},"image":["https:\/\/ymlai87416.github.io\/images\/Apple-Devices-Preview.png"],"genre":"algorithm","wordcount":1529,"url":"https:\/\/ymlai87416.github.io\/algorithm\/string\/","datePublished":"2022-04-04T00:00:00+00:00","dateModified":"2022-04-04T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Tom","logo":"https:\/\/ymlai87416.github.io\/images\/avatar.jpg"},"author":{"@type":"Person","name":"Tom"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/blog/>Blog </a><a class=menu-item href=/cheatsheet/>Cheatsheet </a><a class=menu-item href=/tools/>Tools </a><a class=menu-item href=/link/>Link </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/blog/ title>Blog</a><a class=menu-item href=/cheatsheet/ title>Cheatsheet</a><a class=menu-item href=/tools/ title>Tools</a><a class=menu-item href=/link/ title>Link</a><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animated pulse faster">Strings</h1><div class=content id=content><h1 id=string>String</h1><h2 id=kmp-searching>KMP searching</h2><p>Time complexity: O(m+n)</p><p>Can use to detect longest parlindrom from the beginning</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>final</span> <span class=kt>int</span> <span class=n>MAX_N</span> <span class=o>=</span> <span class=n>1_000_001</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span><span class=o>[]</span> <span class=n>T</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>char</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>char</span><span class=o>[]</span> <span class=n>P</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>char</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span> <span class=c1>// T = text, P = pattern
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>b</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=o>,</span> <span class=n>m</span><span class=o>;</span> <span class=c1>// b = back table, n = length of T, m = length of P
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>kmpPreprocess</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// call this before calling kmpSearch()
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>,</span> <span class=n>j</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=o>[</span><span class=n>0</span><span class=o>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span> <span class=c1>// starting values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=o>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// pre-process the pattern string P
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span> <span class=o>(</span><span class=n>j</span> <span class=o>&gt;=</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=n>P</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>!=</span> <span class=n>P</span><span class=o>[</span><span class=n>j</span><span class=o>])</span> <span class=n>j</span> <span class=o>=</span> <span class=n>b</span><span class=o>[</span><span class=n>j</span><span class=o>];</span> <span class=c1>// different, reset j using b
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>i</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span><span class=o>++;</span> <span class=c1>// if same, advance both pointers
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>b</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>j</span><span class=o>;</span> <span class=c1>// observe i = 8, 9, 10, 11, 12, 13 with j = 0, 1, 2, 3, 4, 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=c1>// in the example of P = &#34;SEVENTY SEVEN&#34; above
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>kmpSearch</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// this is similar as kmpPreprocess(), but on string T
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>,</span> <span class=n>j</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// starting values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=o>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// search through string T
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span> <span class=o>(</span><span class=n>j</span> <span class=o>&gt;=</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=n>T</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>!=</span> <span class=n>P</span><span class=o>[</span><span class=n>j</span><span class=o>])</span> <span class=n>j</span> <span class=o>=</span> <span class=n>b</span><span class=o>[</span><span class=n>j</span><span class=o>];</span> <span class=c1>// different, reset j using b
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>i</span><span class=o>++;</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span><span class=o>++;</span> <span class=c1>// if same, advance both pointers
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>j</span> <span class=o>==</span> <span class=n>m</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// a match found when j == m
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;%s is found at index %d in T\n&#34;</span><span class=o>,</span> <span class=n>String</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>P</span><span class=o>,</span> <span class=n>0</span><span class=o>,</span> <span class=n>m</span><span class=o>),</span> <span class=n>i</span> <span class=o>-</span> <span class=n>j</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>j</span> <span class=o>=</span> <span class=n>b</span><span class=o>[</span><span class=n>j</span><span class=o>];</span> <span class=c1>// prepare j for the next possible match
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://github.com/ymlai87416/algorithm_practice/blob/e1081a55e42fbde08c0514e60008d96770942531/java/src/main/java/StringProcessing/StringMatchingStandard/UVA1449.java target=_blank rel="noopener noreffer">UVA1449</a></p><h2 id=wildcard-matching>Wildcard matching</h2><p>Time complexity: O(S+P)
Similar to KMP matching, just go back to the last star position and match again, but now star match 1 more character.
Better than DP.</p><p>Refer: <a href=https://leetcode.com/submissions/detail/230018120/ target=_blank rel="noopener noreffer">Wildcard Matching</a></p><h2 id=minimum-edit-distance>Minimum edit distance</h2><p>Operation include: insert, delete, replace</p><p>Time complexity: O(m*n)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kt>int</span> <span class=nf>minDistance</span><span class=o>(</span><span class=n>String</span> <span class=n>word1</span><span class=o>,</span> <span class=n>String</span> <span class=n>word2</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span><span class=o>[][]</span> <span class=n>dp</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>word1</span><span class=o>.</span><span class=na>length</span><span class=o>()+</span><span class=n>1</span><span class=o>][</span><span class=n>word2</span><span class=o>.</span><span class=na>length</span><span class=o>()+</span><span class=n>1</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dp</span><span class=o>[</span><span class=n>0</span><span class=o>][</span><span class=n>0</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>word1</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=o>++</span><span class=n>i</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>+</span><span class=n>1</span><span class=o>][</span><span class=n>0</span><span class=o>]</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=n>1</span><span class=o>;</span> <span class=c1>//delete char
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>word2</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=o>++</span><span class=n>i</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=n>dp</span><span class=o>[</span><span class=n>0</span><span class=o>][</span><span class=n>i</span><span class=o>+</span><span class=n>1</span><span class=o>]</span> <span class=o>=</span> <span class=n>i</span><span class=o>+</span><span class=n>1</span><span class=o>;</span> <span class=c1>//delete char
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>1</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;=</span><span class=n>word1</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=n>1</span><span class=o>;</span> <span class=n>j</span><span class=o>&lt;=</span><span class=n>word2</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=o>++</span><span class=n>j</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=kt>char</span> <span class=n>ci</span> <span class=o>=</span> <span class=n>word1</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>char</span> <span class=n>cj</span> <span class=o>=</span> <span class=n>word2</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>j</span><span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>ci</span><span class=o>==</span><span class=n>cj</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=n>1</span><span class=o>];</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>                <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=n>1</span><span class=o>]+</span><span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>],</span> <span class=n>Math</span><span class=o>.</span><span class=na>min</span><span class=o>(</span><span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>][</span><span class=n>j</span><span class=o>]+</span><span class=n>1</span><span class=o>,</span> <span class=n>dp</span><span class=o>[</span><span class=n>i</span><span class=o>][</span><span class=n>j</span><span class=o>-</span><span class=n>1</span><span class=o>]+</span><span class=n>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dp</span><span class=o>[</span><span class=n>word1</span><span class=o>.</span><span class=na>length</span><span class=o>()][</span><span class=n>word2</span><span class=o>.</span><span class=na>length</span><span class=o>()];</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://leetcode.com/submissions/detail/234447813/ target=_blank rel="noopener noreffer">Edit Distance</a></p><h2 id=longest-common-substring>Longest common substring</h2><h2 id=longest-palindrom>Longest palindrom</h2><p>From starting
In between</p><h2 id=suffix-trie>Suffix trie</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><h2 id=suffix-tree>Suffix tree</h2><ul><li>string matching O(m + occ)</li><li>longest repeating substring O(n)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><h2 id=suffix-array>Suffix array</h2><p>Construction of SA</p><p>Time complexity: O(n log(n))
Time complexity of sorting string array using strcmp is O(n^2 log(n))</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>MAX_N</span> <span class=o>=</span> <span class=n>100_010</span><span class=o>;</span> <span class=c1>// second approach: O(n log n)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>char</span><span class=o>[]</span> <span class=n>T</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>char</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span> <span class=c1>// the input string, up to 100K characters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>n</span><span class=o>;</span> <span class=c1>// the length of input string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>RA</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>],</span> <span class=n>tempRA</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span> <span class=c1>// rank array and temporary rank array
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>SA</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span> <span class=o>[</span><span class=n>MAX_N</span><span class=o>],</span> <span class=n>tempSA</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span> <span class=c1>// suffix array and temporary suffix array
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span><span class=o>[]</span> <span class=n>c</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>countingSort</span><span class=o>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// O(n)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=n>sum</span><span class=o>,</span> <span class=n>maxi</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>max</span><span class=o>(</span><span class=n>300</span><span class=o>,</span> <span class=n>n</span><span class=o>);</span> <span class=c1>// up to 255 ASCII chars or length of n
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>c</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span> <span class=c1>// clear frequency table
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// count the frequency of each integer rank
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>c</span><span class=o>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>?</span> <span class=n>RA</span><span class=o>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>k</span><span class=o>]</span> <span class=o>:</span> <span class=n>0</span><span class=o>]++;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>sum</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>maxi</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>c</span><span class=o>[</span><span class=n>i</span><span class=o>];</span> <span class=n>c</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>sum</span><span class=o>;</span> <span class=n>sum</span> <span class=o>+=</span> <span class=n>t</span><span class=o>;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// shuffle the suffix array if necessary
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>tempSA</span><span class=o>[</span><span class=n>c</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]+</span><span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>?</span> <span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]+</span><span class=n>k</span><span class=o>]</span> <span class=o>:</span> <span class=n>0</span><span class=o>]++]</span> <span class=o>=</span> <span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// update the suffix array SA
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>tempSA</span><span class=o>[</span><span class=n>i</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>constructSA</span><span class=o>()</span> <span class=o>{</span> <span class=c1>// this version can go up to 100000 characters
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=n>k</span><span class=o>,</span> <span class=n>r</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=n>RA</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>T</span><span class=o>[</span><span class=n>i</span><span class=o>];</span> <span class=c1>// initial rankings
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>i</span><span class=o>;</span> <span class=c1>// initial SA: {0, 1, 2, ..., n-1}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>k</span> <span class=o>=</span> <span class=n>1</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;&lt;=</span> <span class=n>1</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// repeat sorting process log n times
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>countingSort</span><span class=o>(</span><span class=n>k</span><span class=o>);</span> <span class=c1>// actually radix sort: sort based on the second item
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>countingSort</span><span class=o>(</span><span class=n>0</span><span class=o>);</span> <span class=c1>// then (stable) sort based on the first item
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>tempRA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>0</span><span class=o>]]</span> <span class=o>=</span> <span class=n>r</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=c1>// re-ranking; start from rank r = 0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>1</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// compare adjacent suffixes
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>tempRA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]]</span> <span class=o>=</span> <span class=c1>// if same pair =&gt; same rank r; otherwise, increase r
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=o>(</span><span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]]</span> <span class=o>==</span> <span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>]]</span> <span class=o>&amp;&amp;</span> <span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]+</span><span class=n>k</span><span class=o>]</span> <span class=o>==</span> <span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>]+</span><span class=n>k</span><span class=o>])</span> <span class=o>?</span> <span class=n>r</span> <span class=o>:</span> <span class=o>++</span><span class=n>r</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// update the rank array RA
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>RA</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>tempRA</span><span class=o>[</span><span class=n>i</span><span class=o>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>RA</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>n</span><span class=o>-</span><span class=n>1</span><span class=o>]]</span> <span class=o>==</span> <span class=n>n</span><span class=o>-</span><span class=n>1</span><span class=o>)</span> <span class=k>break</span><span class=o>;</span> <span class=c1>// nice optimization trick
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//in main
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>n</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>length</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>T</span><span class=o>,</span> <span class=sc>&#39;\0&#39;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>_n</span><span class=o>;</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>T</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>T</span><span class=o>[</span><span class=n>n</span><span class=o>++]</span> <span class=o>=</span> <span class=sc>&#39;$&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>constructSA</span><span class=o>();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>string matching O(m log n) <a href=https://github.com/ymlai87416/algorithm_practice/blob/e8b0de3670b3a19f3b5f7b98491c5e7ea0dbd31f/java/src/main/java/StringProcessing/SuffixArray/UVA1254.java target=_blank rel="noopener noreffer">UVA1254</a></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//return (-1, -1) if not found
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Pair</span> <span class=nf>stringMatching</span><span class=o>(</span><span class=n>String</span> <span class=n>P</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// string matching in O(m log n)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>P</span><span class=o>.</span><span class=na>length</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>lo</span> <span class=o>=</span> <span class=n>0</span><span class=o>,</span> <span class=n>hi</span> <span class=o>=</span> <span class=n>n</span><span class=o>-</span><span class=n>1</span><span class=o>,</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>lo</span><span class=o>;</span> <span class=c1>// valid matching = [0..n-1]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=o>(</span><span class=n>lo</span> <span class=o>&lt;</span> <span class=n>hi</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// find lower bound
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>mid</span> <span class=o>=</span> <span class=o>(</span><span class=n>lo</span> <span class=o>+</span> <span class=n>hi</span><span class=o>)</span> <span class=o>/</span> <span class=n>2</span><span class=o>;</span> <span class=c1>// this is round down
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>strncmp</span><span class=o>(</span><span class=n>T</span><span class=o>,</span> <span class=n>SA</span><span class=o>[</span><span class=n>mid</span><span class=o>],</span> <span class=n>P</span><span class=o>,</span> <span class=n>m</span><span class=o>);</span> <span class=c1>// try to find P in suffix ’mid’
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>res</span> <span class=o>&gt;=</span> <span class=n>0</span><span class=o>)</span> <span class=n>hi</span> <span class=o>=</span> <span class=n>mid</span><span class=o>;</span> <span class=c1>// prune upper half (notice the &gt;= sign)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=n>lo</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=n>1</span><span class=o>;</span> <span class=c1>// prune lower half including mid
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span> <span class=c1>// observe ‘=’ in &#34;res &gt;= 0&#34; above
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>strncmp</span><span class=o>(</span><span class=n>T</span><span class=o>,</span> <span class=n>SA</span><span class=o>[</span><span class=n>lo</span><span class=o>],</span> <span class=n>P</span><span class=o>,</span> <span class=n>m</span><span class=o>)</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=k>return</span> <span class=k>new</span> <span class=n>Pair</span><span class=o>(-</span><span class=n>1</span><span class=o>,</span> <span class=o>-</span><span class=n>1</span><span class=o>);</span> <span class=c1>// if not found
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Pair</span> <span class=n>ans</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Pair</span><span class=o>(</span><span class=n>0</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span> <span class=n>ans</span><span class=o>.</span><span class=na>first</span> <span class=o>=</span> <span class=n>lo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>lo</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>hi</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=n>1</span><span class=o>;</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>lo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>lo</span> <span class=o>&lt;</span> <span class=n>hi</span><span class=o>)</span> <span class=o>{</span> <span class=c1>// if lower bound is found, find upper bound
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>mid</span> <span class=o>=</span> <span class=o>(</span><span class=n>lo</span> <span class=o>+</span> <span class=n>hi</span><span class=o>)</span> <span class=o>/</span> <span class=n>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=n>strncmp</span><span class=o>(</span><span class=n>T</span><span class=o>,</span> <span class=n>SA</span><span class=o>[</span><span class=n>mid</span><span class=o>],</span> <span class=n>P</span><span class=o>,</span> <span class=n>m</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>res</span> <span class=o>&gt;</span> <span class=n>0</span><span class=o>)</span> <span class=n>hi</span> <span class=o>=</span> <span class=n>mid</span><span class=o>;</span> <span class=c1>// prune upper half
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=n>lo</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=n>1</span><span class=o>;</span> <span class=c1>// prune lower half including mid
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span> <span class=c1>// (notice the selected branch when res == 0)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=o>(</span><span class=n>strncmp</span><span class=o>(</span><span class=n>T</span><span class=o>,</span> <span class=n>SA</span><span class=o>[</span><span class=n>hi</span><span class=o>],</span> <span class=n>P</span><span class=o>,</span> <span class=n>m</span><span class=o>)</span> <span class=o>!=</span> <span class=n>0</span><span class=o>)</span> <span class=n>hi</span><span class=o>--;</span> <span class=c1>// special case
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>ans</span><span class=o>.</span><span class=na>second</span> <span class=o>=</span> <span class=n>hi</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=c1>// return lower/upperbound as first/second item of the pair, respectively
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>strncmp</span><span class=o>(</span><span class=kt>char</span><span class=o>[]</span> <span class=n>str1</span><span class=o>,</span> <span class=kt>int</span> <span class=n>startPos</span><span class=o>,</span> <span class=n>String</span> <span class=n>P</span><span class=o>,</span> <span class=kt>int</span> <span class=n>num</span> <span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>num</span><span class=o>;</span> <span class=o>++</span><span class=n>i</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>a</span> <span class=o>=</span> <span class=n>str1</span><span class=o>[</span><span class=n>startPos</span><span class=o>+</span><span class=n>i</span><span class=o>];</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>b</span> <span class=o>=</span> <span class=n>P</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>a</span> <span class=o>!=</span> <span class=n>b</span><span class=o>)</span> <span class=k>return</span> <span class=o>(</span><span class=kt>int</span><span class=o>)(</span><span class=n>a</span><span class=o>-</span><span class=n>b</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>longest prefix O(n)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>Phi</span><span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>PLCP</span><span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>[]</span> <span class=n>LCP</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>int</span><span class=o>[</span><span class=n>MAX_N</span><span class=o>];</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>computeLCP</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=n>L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Phi</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>0</span><span class=o>]]</span> <span class=o>=</span> <span class=o>-</span><span class=n>1</span><span class=o>;</span> <span class=c1>// default value
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>1</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// compute Phi in O(n)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Phi</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]]</span> <span class=o>=</span> <span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=n>1</span><span class=o>];</span> <span class=c1>// remember which suffix is behind this suffix
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>L</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span> <span class=c1>// compute Permuted LCP in O(n)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>Phi</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>==</span> <span class=o>-</span><span class=n>1</span><span class=o>)</span> <span class=o>{</span> <span class=n>PLCP</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=k>continue</span><span class=o>;</span> <span class=o>}</span> <span class=c1>// special case
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span> <span class=o>(</span><span class=n>T</span><span class=o>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>L</span><span class=o>]</span> <span class=o>==</span> <span class=n>T</span><span class=o>[</span><span class=n>Phi</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>+</span> <span class=n>L</span><span class=o>])</span> <span class=n>L</span><span class=o>++;</span> <span class=c1>// L increased max n times
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>PLCP</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>L</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>L</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>max</span><span class=o>(</span><span class=n>L</span><span class=o>-</span><span class=n>1</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span> <span class=c1>// L decreased max n times
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=c1>// compute LCP in O(n)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>LCP</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>PLCP</span><span class=o>[</span><span class=n>SA</span><span class=o>[</span><span class=n>i</span><span class=o>]];</span> <span class=c1>// put the permuted LCP to the correct position
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Longest common substring
Time complexity: O(n)</li></ul><p>for T1= GATAGACA and T2=CATA, concat both string to become GATAGACA$CATA#.</p><p>Go through the suffix array to see if 2 consecutive suffix belongs to 2 different word.</p><p>Refer: <a href rel></a></p><ul><li>Longest repeating substring
Time complexity: O(n)</li></ul><p>Refer: <a href=https://leetcode.com/submissions/detail/689901108/ target=_blank rel="noopener noreffer">Longest Duplicate substring</a></p><h2 id=rolling-hash---rabin-karp>Rolling hash - Rabin Karp</h2><p>Time complexity: O(m+n)
Space complexity: O(n)</p><p>Time complexity is same as KMP.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>modulo</span> <span class=o>=</span> <span class=n>1_000_000_007</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=kt>long</span> <span class=nf>modPow</span><span class=o>(</span><span class=kt>int</span> <span class=n>base</span><span class=o>,</span> <span class=kt>int</span> <span class=n>exp</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>exp</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span> <span class=k>return</span> <span class=n>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span><span class=o>(</span><span class=n>exp</span> <span class=o>==</span> <span class=n>1</span><span class=o>)</span> <span class=k>return</span> <span class=n>base</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>long</span> <span class=n>d</span> <span class=o>=</span> <span class=n>modPow</span><span class=o>(</span><span class=n>base</span><span class=o>,</span> <span class=n>exp</span><span class=o>/</span><span class=n>2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=n>exp</span> <span class=o>%</span> <span class=n>2</span> <span class=o>==</span> <span class=n>0</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>(</span><span class=n>d</span> <span class=o>*</span> <span class=n>d</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>((</span><span class=n>d</span> <span class=o>*</span> <span class=n>d</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span> <span class=o>*</span> <span class=n>base</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//in main
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>long</span> <span class=n>p26</span> <span class=o>=</span> <span class=n>modPow</span><span class=o>(</span><span class=n>26</span><span class=o>,</span> <span class=n>len</span><span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//in loop
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>c</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>)</span> <span class=o>-</span> <span class=sc>&#39;a&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>charAt</span><span class=o>(</span><span class=n>i</span><span class=o>-</span><span class=n>len</span><span class=o>)</span> <span class=o>-</span> <span class=sc>&#39;a&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>rolling</span> <span class=o>=</span> <span class=o>(</span><span class=n>rolling</span> <span class=o>-</span> <span class=o>(</span><span class=n>q</span> <span class=o>*</span> <span class=n>p26</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span> <span class=o>+</span> <span class=n>modulo</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>rolling</span> <span class=o>=</span> <span class=o>(</span><span class=n>rolling</span> <span class=o>*</span> <span class=n>26</span> <span class=o>+</span> <span class=n>c</span><span class=o>)</span> <span class=o>%</span> <span class=n>modulo</span><span class=o>;</span>
</span></span></code></pre></td></tr></table></div></div><p>Refer: <a href=https://leetcode.com/submissions/detail/696974797/ target=_blank rel="noopener noreffer">Longest Duplicate Substring</a></p><h2 id=aho-corasick>Aho corasick</h2><p>It can match a dictionary to a string simultaneously.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java></code></pre></td></tr></table></div></div><p>Refer: <a href=https://leetcode.com/problems/stream-of-characters/ target=_blank rel="noopener noreffer"></a></p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Lai Yiu Ming, Tom</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"",maxShownLines:100},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>