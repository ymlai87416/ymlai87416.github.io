---
title: "Spark"
date: "2023-04-07"
author: "Tom"

toc:
  enable: true
  auto: true
---

## Spark

- JavaRDD
- JavaPairRDD
- Dataset
- BloomFilter

### Simple operation

#### RDD
| Opertion          | SQL example                                                                                                                                                    | Formatted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| select            | select * from airports                                                                                                                                         | airports                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| select            | select * from airports limit 3                                                                                                                                 | airports.take(3) / airports.sample(3)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| select            | select id from airports where ident=‘KLAX’                                                                                                                     | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"KLAX".compareTo(node.get("ident").asText())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| select            | select distinct type from airport                                                                                                                              | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;node.get("type").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.distinct()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| where             | select * from airports where iso_region=‘US-CA’ and type=‘seaplane_base’                                                                                       | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"US-CA".compareTo(node.get("iso_region").asText()&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&&&nbsp;"seaplane_base".compareTo(node.get("type").asText())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| where             | select ident, name, municipality from airports where iso_region=‘US-CA’ and type=‘seaplane_base’                                                               | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"US-CA".compareTo(node.get("iso_region").asText()&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&&&nbsp;"seaplane_base".compareTo(node.get("type").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;"ident",&nbsp;"name",&nbsp;"municipality")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| order by          | select * from airport_freq where airport_ident=‘KLAX’ order by type                                                                                            | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"KLAX".compareTo(node.get("ident").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(node&nbsp;->&nbsp;node.get("type").asText(),&nbsp;true)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| order by          | select * from airport_freq where airport_ident = ‘KLAX’ order by type desc                                                                                     | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"KLAX".compareTo(node.get("ident").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(node&nbsp;->&nbsp;node.get("type").asText(),&nbsp;false)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| in                | select * from airports where type in (‘heliport’, ‘balloonport’)                                                                                               | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;ImmutableSet.of("heliport",&nbsp;"balloonport").contains(node.get("type").asText())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| not in            | select * from airports where type not in (‘heliport’, ‘balloonport’)                                                                                           | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;!ImmutableSet.of("heliport",&nbsp;"balloonport").contains(node.get("type").asText())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| group+count       | select iso_country, type, count(*) from airports group by iso_country, type order by iso_country, type                                                         | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.mapToPair(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;"iso_country",&nbsp;"type"))<br>&nbsp;&nbsp;&nbsp;&nbsp;.reduceByKey((x,&nbsp;y)&nbsp;->&nbsp;x&nbsp;+&nbsp;y);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| group+count+order | select iso_country, type, count(*) from airports group by iso_country, type order by iso_country, count(*) desc                                                | airports<br>.mapToPair(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;"iso_country",&nbsp;"type")).reduceByKey((x,&nbsp;y)&nbsp;->&nbsp;x&nbsp;+&nbsp;y)<br>.map(pair&nbsp;->&nbsp;Json.objectMapper().put("iso_country",&nbsp;pair._1.get("iso_country").asText())<br>.put("type",&nbsp;pair._1.get("type").asText())<br>.put("count",&nbsp;pair._2))<br>.sortBy(node&nbsp;->&nbsp;new&nbsp;Tuple2<>(node.get("iso_country").asText(),&nbsp;-node.get("count").asInt()),&nbsp;false)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| having            | select type, count(*) from airports where iso_country = ‘US’ group by type having count(*) > 1000 order by count(*) desc                                       | airports<br>&nbsp;&nbsp;&nbsp;&nbsp;.mapToPair(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;""iso_country"",&nbsp;""type"")).reduceByKey((x,&nbsp;y)&nbsp;->&nbsp;x&nbsp;+&nbsp;y)<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(pair&nbsp;->&nbsp;Json.objectMapper().put(""iso_country"",&nbsp;pair._1.get(""iso_country"").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put(""type"",&nbsp;pair._1.get(""type"").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put(""count"",&nbsp;pair._2))<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;node.get("count").asInt()&nbsp;>&nbsp;1000)<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(node&nbsp;->&nbsp;node.get("count").asInt()),&nbsp;false)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| topN              | select iso_country from by_country order by size desc limit 10                                                                                                 | by_country<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(node&nbsp;->&nbsp;node.get("size").asText(),&nbsp;true)<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;node.get("iso_country").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.take(10)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| topN+offset       | select iso_country from by_country order by size desc limit 10 offset 10                                                                                       | by_country<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(node&nbsp;->&nbsp;node.get("size").asText(),&nbsp;true)<br>&nbsp;&nbsp;&nbsp;&nbsp;.zipWithIndex()<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(pair&nbsp;->&nbsp;pair._2&nbsp;>=&nbsp;10&nbsp;&&&nbsp;pair._2&nbsp;<&nbsp;10+20)<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;node.get("iso_country").asText())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| aggregate         | select max(length_ft), min(length_ft), avg(length_ft), median(length_ft) from runways                                                                          | JavaRDD<Integer>&nbsp;columnRDD&nbsp;=&nbsp;runways.map(row&nbsp;->&nbsp;node.get("length_ft").asDouble());&nbsp;//&nbsp;Extract&nbsp;the&nbsp;column&nbsp;from&nbsp;the&nbsp;JavaRDD<br>double&nbsp;max&nbsp;=&nbsp;columnRDD.max();<br>double&nbsp;min&nbsp;=&nbsp;columnRDD.min();<br>double&nbsp;avg&nbsp;=&nbsp;columnRDD.mean();<br>double&nbsp;median&nbsp;=&nbsp;columnRDD<br>&nbsp;&nbsp;&nbsp;&nbsp;.mapToDouble(x&nbsp;->&nbsp;x)<br>&nbsp;&nbsp;&nbsp;&nbsp;.sortBy(x&nbsp;->&nbsp;x)<br>&nbsp;&nbsp;&nbsp;&nbsp;.zipWithIndex()<br>&nbsp;&nbsp;&nbsp;&nbsp;.mapToDouble(pair&nbsp;->&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;count&nbsp;=&nbsp;columnRDD.count();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;index&nbsp;=&nbsp;pair._2();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;value&nbsp;=&nbsp;pair._1();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(count&nbsp;%&nbsp;2&nbsp;==&nbsp;0)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(index&nbsp;==&nbsp;count&nbsp;/&nbsp;2&nbsp;-&nbsp;1)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(index&nbsp;==&nbsp;count&nbsp;/&nbsp;2)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(value&nbsp;+&nbsp;columnRDD.zipWithIndex()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.filter(p&nbsp;->&nbsp;p._2()&nbsp;==&nbsp;count&nbsp;/&nbsp;2&nbsp;-&nbsp;1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mapToDouble(p&nbsp;->&nbsp;p._1())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.sum())&nbsp;/&nbsp;2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(index&nbsp;==&nbsp;count&nbsp;/&nbsp;2)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;.sum()&nbsp;/&nbsp;columnRDD.count(); |
| join              | select airport_ident, type, description, frequency_mhz from airport_freq join airports on airport_freq.airport_ref = airports.id where airports.ident = ‘KLAX’ | JavaPairRDD<String,&nbsp;JsonNode>&nbsp;airport_freq_key=&nbsp;airport_freq.keyBy(node&nbsp;->&nbsp;node.get("airport_ref").asText());<br>JavaPairRDD<String,&nbsp;JsonNode>&nbsp;airports_key&nbsp;=&nbsp;airports.keyBy(node&nbsp;->&nbsp;node.get("id").asText());<br>airport_freq_key.join(airports_key,&nbsp;"inner_join")<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(tuple&nbsp;->&nbsp;Json.objectMaper()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put("airport_ident",&nbsp;tuple._1.get("ident").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put("type",&nbsp;tuple._1.get("type").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put("description",&nbsp;tuple._1.get("description").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.put("frequency_mhz",&nbsp;tuple._2.get("frequency_mhz").asText())<br>&nbsp;&nbsp;&nbsp;&nbsp;.filter(node&nbsp;->&nbsp;"KLAX".compareTo(node.get("ident")))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| union             | select name, municipality from airports where ident = ‘KLAX’ union all select name, municipality from airports where ident = ‘KLGB’                            | JavaRDD<JsonNode>&nbsp;rdd1&nbsp;=&nbsp;airports.filter(node&nbsp;->&nbsp;"KLAX".compareTo(node.get("ident").asText()))<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;"name",&nbsp;"municipality"))<br>JavaRDD<JsonNode>&nbsp;rdd2&nbsp;=&nbsp;airports.filter(node&nbsp;->&nbsp;"KLGB".compareTo(node.get("ident").asText()))<br>&nbsp;&nbsp;&nbsp;&nbsp;.map(node&nbsp;->&nbsp;Json.copyFields(node,&nbsp;"name",&nbsp;"municipality"))<br>rdd1.union(rdd2)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |


#### Dataset

TBC

### MLib

TBC

### Streaming

TBC

### GraphX

TBC