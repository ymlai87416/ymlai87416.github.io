<!doctype html><html lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Udacity Self Driving Car Term2 - Tom personal site</title><meta name=Description content="Tom personal web site"><meta property="og:title" content="Udacity Self Driving Car Term2"><meta property="og:description" content="Term 2 is finished, and I want to share with you want I have learned in this term.
This term focus on control, I learn how to use Kalman filter, particle filter, PID controller and MPC controller. This term requires C++ to finish but I have used it before.
In term 2, the course teaches you the followings:
Extended Kalman filter and Unscented Kalman filter When you have both lidar and radar and you want to extract the good from both of them, Kalman filter is the tool to use."><meta property="og:type" content="article"><meta property="og:url" content="https://ymlai87416.github.io/blog/udacity-self-driving-car-term2/"><meta property="og:image" content="https://ymlai87416.github.io/logo.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2018-04-30T00:00:00+08:00"><meta property="article:modified_time" content="2018-04-30T00:00:00+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ymlai87416.github.io/logo.png"><meta name=twitter:title content="Udacity Self Driving Car Term2"><meta name=twitter:description content="Term 2 is finished, and I want to share with you want I have learned in this term.
This term focus on control, I learn how to use Kalman filter, particle filter, PID controller and MPC controller. This term requires C++ to finish but I have used it before.
In term 2, the course teaches you the followings:
Extended Kalman filter and Unscented Kalman filter When you have both lidar and radar and you want to extract the good from both of them, Kalman filter is the tool to use."><meta name=application-name content="Tom personal web site"><meta name=apple-mobile-web-app-title content="Tom personal web site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ymlai87416.github.io/blog/udacity-self-driving-car-term2/><link rel=prev href=https://ymlai87416.github.io/blog/site-move-to-aws/><link rel=next href=https://ymlai87416.github.io/blog/udacity-self-driving-car-term3/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Udacity Self Driving Car Term2","inLanguage":"zh","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ymlai87416.github.io\/blog\/udacity-self-driving-car-term2\/"},"image":["https:\/\/ymlai87416.github.io\/images\/Apple-Devices-Preview.png"],"genre":"blog","keywords":"computer science, artificial intelligence","wordcount":853,"url":"https:\/\/ymlai87416.github.io\/blog\/udacity-self-driving-car-term2\/","datePublished":"2018-04-30T00:00:00+08:00","dateModified":"2018-04-30T00:00:00+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Tom","logo":"https:\/\/ymlai87416.github.io\/images\/avatar.jpg"},"author":{"@type":"Person","name":"Lai Yiu Ming, Tom"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about/>About </a><a class=menu-item href=/blog/>Blog </a><a class=menu-item href=/cheatsheet/>Cheatsheet </a><a class=menu-item href=/tools/>Tools </a><a class=menu-item href=/link/>Link </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Tom personal site">Tom personal site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/blog/ title>Blog</a><a class=menu-item href=/cheatsheet/ title>Cheatsheet</a><a class=menu-item href=/tools/ title>Tools</a><a class=menu-item href=/link/ title>Link</a><a href=javascript:void(0); class="menu-item theme-switch" title>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title></h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Udacity Self Driving Car Term2</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Lai Yiu Ming, Tom</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2018-04-30>2018-04-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span></span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#extended-kalman-filter-and-unscented-kalman-filter>Extended Kalman filter and Unscented Kalman filter</a></li><li><a href=#particle-filter>Particle filter</a></li><li><a href=#pid-controller>PID controller</a></li><li><a href=#mpc-controller>MPC controller</a></li><li><a href=#conclusion>Conclusion:</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>Term 2 is finished, and I want to share with you want I have learned in this term.</p><p>This term focus on control, I learn how to use Kalman filter, particle filter, PID controller and MPC controller. This term requires C++ to finish but I have used it before.</p><p>In term 2, the course teaches you the followings:</p><h3 id=extended-kalman-filter-and-unscented-kalman-filter>Extended Kalman filter and Unscented Kalman filter</h3><p>When you have both lidar and radar and you want to extract the good from both of them, Kalman filter is the tool to use. It combines the information together, predicts the current location and also tells you how sure the prediction is.</p><p>All you need is to tell the Kalman filter what your car model is. Kalman filter makes educated guesses based on the model, instead of blindly trust whatever data lidar and radar generated.</p><p>The project only requires me to track my car, but in the real setting, it can track many objects at the same time. (e.g. the car in front, the car behind, cars on the other lane, pedestrians, and dogs) So your car doesn’t run into these object even when the time lidar or radar or both generate silly data during some short interval.</p><p>Here is my write-up for <a href=https://github.com/ymlai87416/CarND-Extended-Kalman-Filter-Project/blob/master/README.md target=_blank rel="noopener noreffer">Extended Kalman filter</a> and <a href=https://github.com/ymlai87416/CarND-Unscented-Kalman-Filter-Project/blob/master/README.md target=_blank rel="noopener noreffer">Unscented Kalman filter</a></p><h3 id=particle-filter>Particle filter</h3><p>To track your own car, you may think this is just like track your iPhone app, which periodically get the GPS signal and send it to the server. (I don’t know if the guy in Apple really does this, the iPhone get accelerometer and gyroscope, and also it has a WiFi receiver)</p><p>But how about your car is in the tunnel, your car is in the area with inaccurate GPS. The particle filter is here to help you to improve the accuracy of the car location.</p><p>What you have to do is to tell the particle filter how your car moves and a map.</p><p>and your car continues to tell the particle filter what does your car sees on the map (poles, beacons, tree, etc.) and the particle filter uses a sophisticated formula deduced from Navie Bayes algorithm to tell you where your car is.</p><p>Want to see it in <a href=https://youtu.be/NC7rm_UeQSs target=_blank rel="noopener noreffer">action</a>. You can read my <a href=https://github.com/ymlai87416/CarND-Kidnapped-Vehicle-Project/blob/master/README.md target=_blank rel="noopener noreffer">write-up</a> here.</p><h3 id=pid-controller>PID controller</h3><p>I did PID in university and I am dealing with PID again. Recently, I want to buy a drone and seems drone also used PID controller too. Why? to make it stabilized. You have 3 parameters P, I and D, and what you do is to tune them, so that the drone weight, the inertia and the center of gravity, wind speed etc. are all considered. But there is no way to calculate P, I, D from drone physical properties, you have to use trial or error.</p><p>I am doing the same on this project. I use the twiddle algorithm the course teach me to tune the PID but it turns out that the car keeps driving off track. I have to force myself to use traditional way to tune PID first and make the car drives stable enough, I run the car a few laps to find more accurate PID values.</p><p>I make the PID controller works, but it is running at 50mph at most. Check out <a href=https://youtu.be/tF9NMcee8iA target=_blank rel="noopener noreffer">how my car move</a> and my <a href=https://github.com/ymlai87416/CarND-PID-Control-Project target=_blank rel="noopener noreffer">implementation</a>.</p><h3 id=mpc-controller>MPC controller</h3><p>MPC controller is a new concept of controlling algorithm to me, and if I have time maybe I would like to try to implement one to a drone. (which is already done by someone on <a href="https://www.youtube.com/watch?v=lPy7w-GUbw4" target=_blank rel="noopener noreffer">youtube</a>)</p><p>MPC knows your car model, and the desired path (from driving computer, navigation component) and find out the best way to use the control input to make the car drives down the desired path.</p><p>For the model, there are the kinematic model and the dynamic model. The kinematic model considers how the car moves and tunes normally but not drifting or launching or other stunts. I use the kinematic model in this project.</p><p>MPC controller predicts a few seconds forward and use the first set of control input to drive the car, and do it again maybe 100 ms second later. By doing so, the car should be on track. But how MPC predicts? MPC use optimization to find out the desired set of control input so that it can keep the car on-track for a few seconds.</p><p>I did convex optimization before but MPC problem is not a convex problem (i have sine and cosine in the model). When it is not convex, the implication is that the result may be just a local minimum instead of global minimum, but as long as it is not a <a href=https://en.wikipedia.org/wiki/Saddle_point target=_blank rel="noopener noreffer">saddle point</a> (which is not a minimum at all). It should be OK for the purpose.</p><p>No more tuning and my car can run at a higher speed. Please check out the <a href=https://youtu.be/BAdrbRUI8NY target=_blank rel="noopener noreffer">result</a> and also the <a href=https://github.com/ymlai87416/CarND-MPC-Project/blob/master/README.md target=_blank rel="noopener noreffer">implementation</a>.</p><h3 id=conclusion>Conclusion:</h3><p>I now have more stuff in my arsenal to tackle the self-driving car problem. In the next term, I will make it works on a real car !! I don’t know what it will be end-up to.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/blog/udacity-self-driving-car-term2/index.md target=_blank></a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/computer-science/>computer science</a>,&nbsp;<a href=/tags/artificial-intelligence/>artificial intelligence</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()></a></span>&nbsp;|&nbsp;<span><a href=/></a></span></section></div><div class=post-nav><a href=/blog/site-move-to-aws/ class=prev rel=prev title="這個網站已經搬住 amazon web service"><i class="fas fa-angle-left fa-fw"></i>這個網站已經搬住 amazon web service</a>
<a href=/blog/udacity-self-driving-car-term3/ class=next rel=next title="Udacity Self Driving Car Term3">Udacity Self Driving Car Term3<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Lai Yiu Ming, Tom</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"",maxShownLines:100},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>